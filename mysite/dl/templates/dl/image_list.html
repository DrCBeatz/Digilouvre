{% extends "dl_menu.html" %}
{% load humanize %}
{% load static %}
{% block head %}

<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
<style>
    html,
    body {
      position: relative;
      height: 100%;
    }

    .swiper-container {
      width: 100%;
      height: 66%;
    }

    .swiper-slide {
      background-position: center;
      background-size: contain;
      background-color: black;
      background-repeat: no-repeat;

    }

    .swiper-pagination-bullet {
  opacity: 0.5;
    background: var(--swiper-pagination-color, var(--swiper-theme-color));
    background-color: gray;
}
    .swiper-pagination-bullet-active {
    opacity: 1;
    background: var(--swiper-pagination-color, var(--swiper-theme-color));
    background-color: white;
}
.swiper-slide {
  display: block;
}

  </style>

{% endblock %}

{% block carousel %}
{% if image_list %}
<div class="swiper-container swiper-container-fade swiper-container-initialized swiper-container-horizontal swiper-container-pointer-events">
    <div class="swiper-wrapper">

        {% for image in image_carousel_list|slice:":15" %}
    <!--<a class="swiper-slide" style="background-image:url('/media/{{ image.image }}');" href="{% url 'dl:image_detail' image.id %}"></a>-->
    <a class="swiper-slide" style="background-image:url({{ image.preview.url }});" href="{% url 'dl:image_detail' image.id %}"></a>

{% endfor %}
</div>
<div class="swiper-pagination swiper-pagination-white"></div>
  <div class="swiper-button-next swiper-button-white"></div>
  <div class="swiper-button-prev swiper-button-white"></div>

  </div>
{% else %}
{% endif %}
{% endblock %}

{% block content %}

<h1  class="text-center">All Images</h1>


<div class="container">


<div class="infinite-container row">
<!--<div class="row">-->

{% if user.is_authenticated and user.is_superuser %}
    <form action="{% url 'dl:image_create' %}">
        <input class ="form-control form-horizontal btn btn-primary" type="submit" value="Add Image">
    </form>
{% elif user.is_authenticated and user.username == 'guest' %}
<form action="{% url 'dl:image_create' %}"><input class ="form-control form-horizontal btn btn-primary" type="submit" value="Add Image"></form>
{% endif %}

    {% if image_list %}
  {% for image in image_list %}



    {% if forloop.first %}<div class="infinite-item row">{% endif %}
    <div class="col-md-4" >
        <div class="thumbnail">
            <a href="{% url 'dl:image_detail' image.id %}">
                <!--<img  class="img-responsive center-block" src="/media/{{ image.image }}">-->
                <img  class="img-responsive center-block" src="{{ image.thumbnail.url }}">

                <div class="caption"> <h4 class="text-center">{{image.title}}</h4>
                <p class="text-center"><em>{{image.category.title}}</em></p>
                <!--<p class="text-center"><small>Posted {{ image.updated_at|naturaltime }}</small></p>-->

                </div>
            </a>
        </div>


        </div>
    {% if forloop.counter|divisibleby:3 %}</div><div class="row">{% endif %}
    {% if forloop.last %}</div>{% endif %}


  {% endfor %}

<!--</div>-->
</div>
{% if page_obj.has_next %}
                <a class="infinite-more-link" href="?page={{ page_obj.next_page_number }}">Loading Images...</a>
                {% endif %}
                <!--<div class="d-flex justify-content-center" style="display:none;">-->
                <!--    <div class="spinner-border" role="status">-->
                <!--        <span class="sr-only">Loading...</span>-->
                <!--    </div>-->
                <!--</div>-->

{% else %}
  <p>There are no images in the database.</p>
{% endif %}

<!--</p>-->
</div>

<script src="/static/js/jquery-2.2.4.min.js"></script>
    <script src="/static/js/jquery.waypoints.min.js"></script>
    <script src="/static/js/infinite.min.js"></script>
<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script>
    var swiper = new Swiper('.swiper-container', {
        observer: true,
        observeParents: true,
      spaceBetween: 30,
      loop: true,
      centeredSlides: true,
      effect: 'fade',
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      autoplay: {
        delay: 2500,
        disableOnInteraction: false,
      },
    });
  </script>
  <script>
    var infinite = new Waypoint.Infinite({
        element: $('.infinite-container')[0],
        handler: function(direction) {

    },
    offset: 'bottom-in-view',

    onBeforePageLoad: function () {
    $('.spinner-border').show();
    },
    onAfterPageLoad: function () {
    $('.spinner-border').hide();
    }

    });

    </script>
{% endblock %}
